
<div class="container mid" ng-controller="AdminPanelController as adminPanelCtrl">
    <a id="top"></a>
	<h1 class="text-center">
		{{admin-h1}}
	</h1>
	<br>

    <div class="row">
        <div class="row-fluid">
            <ul class="nav nav-tabs nav-justified">
                <li class="main-menu-list-item" ng-class="{'selected-filter':adminPanelCtrl.viewingAll}" ng-click="adminPanelCtrl.changeView('all')"><a class="pointer">{{admin-all}}</a></li>
                <!--<li class="main-menu-list-item" ng-class="{'selected-filter':adminPanelCtrl.viewingUsers}" ng-click="adminPanelCtrl.changeView('users')"><a class="pointer">Users</a></li>-->
                <li class="main-menu-list-item" ng-class="{'selected-filter':adminPanelCtrl.viewingEmployees}" ng-click="adminPanelCtrl.changeView('employees')"><a class="pointer">{{admin-officers}}</a></li>
                <li class="main-menu-list-item" ng-class="{'selected-filter':adminPanelCtrl.viewingAdministrators}" ng-click="adminPanelCtrl.changeView('administrators')"><a class="pointer">{{admin-admin}}</a></li>
                <!--<li class="main-menu-list-item" ng-class="{'selected-filter':adminPanelCtrl.viewingLoggedIn}" ng-click="adminPanelCtrl.changeView('loggedIn')"><a class="pointer">Logged In</a></li>-->
                <li class="main-menu-list-item" ng-class="{'selected-filter':adminPanelCtrl.addingUser}" ng-click="adminPanelCtrl.changeView('addUser')"><a class="pointer">{{admin-newuser}}</a></li>
            </ul>
        </div>

        <span us-spinner="{radius:30, width:15, length: 0, color: '#219ef9'}" spinner-key="loading-video-archive-spinner" spinner-start-active="1"/>

        <div class="row-fluid admin-panel-main-container">

            <nav class="navbar navbar-default admin-panel-navbar" ng-show="!adminPanelCtrl.addingUser && !adminPanelCtrl.editingUser && adminPanelCtrl.usersAvailable && !adminPanelCtrl.fetchingUsers">
                <div class="container-fluid">
                    <ul class="nav navbar-nav navbar-left">
                        <li class="dropdown">
                            <a class="dropdown-toggle pointer" data-toggle="dropdown" role="button" aria-expanded="false">{{admin-bulk}}<span class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <!--<li><a>Add to Users</a></li>-->
                                <li><a class="pointer" ng-click="adminPanelCtrl.updateRole('add','employee')">{{admin-addo}}</a></li>
                                <li><a class="pointer" ng-click="adminPanelCtrl.updateRole('remove','employee')">{{admin-removeO}}</a></li>
                                <li><a class="pointer" ng-click="adminPanelCtrl.updateRole('add','admin')">Add to Administrators</a></li>
                                <li><a class="pointer" ng-click="adminPanelCtrl.updateRole('remove','admin')">{{admin-addA}}</a></li>
                                <li class="divider"></li>
                                <li class="pointer"><a ng-click="adminPanelCtrl.deleteUser()">{{admin-deleteS}}<i class="glyphicon glyphicon-trash pointer pull-right"></i></a></li>
                            </ul>
                        </li>
                    </ul>
                    <form class="navbar-form admin-panel-action-form navbar-left" role="search">
                        <div class="form-group">{{admin-registration}}
                            <input class="form-control" type="date" placeholder="Registration Date" ng-model="adminPanelCtrl.registrationDate"/>
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Username or Email" ng-model="adminPanelCtrl.searchString"/>
                        </div>
                        <button type="submit" class="btn btn-default btn-primary" ng-click="adminPanelCtrl.getPage(adminPanelCtrl.currentPageNum)">{{admin-filter}}</button>
                    </form>
                    <ul class="nav navbar-nav navbar-right">
                        <li class="pointer" id="add-user-button" ng-click="adminPanelCtrl.changeView('addUser')"><i class="glyphicon glyphicon-plus"></i></li>
                    </ul>
                </div><!-- /.container-fluid -->
            </nav>
            <!-- Tab panes -->
            <div class="tab-content">
                <div class="tab-pane user-list" ng-class="{'active':!adminPanelCtrl.addingUser && !adminPanelCtrl.editingUser}" ng-show="adminPanelCtrl.usersAvailable && !adminPanelCtrl.fetchingUsers">
                    <div class="paginationText">
                        <p ng-show="adminPanelCtrl.usersAvailable">Page {{adminPanelCtrl.currentPageNum}} of {{adminPanelCtrl.lastPageNum}}</p>
                        <p ng-show="adminPanelCtrl.usersAvailable">Showing {{adminPanelCtrl.skip + 1}} - {{adminPanelCtrl.skip + 10 > adminPanelCtrl.userTotal ? adminPanelCtrl.userTotal : adminPanelCtrl.skip + 10}} of {{adminPanelCtrl.userTotal}} Users</p>
                    </div>
                    <!--Show if NO video archives are available -->
                    <div ng-show="!adminPanelCtrl.usersAvailable">
                        <h2 class="text-center">{{admin-record}}</h2>
                        <h3 class="text-center">{{admin-error}}</h3>
                    </div>

                    <!--======SPINNER (LOADING)======-->

                    <h3 class="text-center"  ng-class="{'green':!adminPanelCtrl.hasError, 'red':adminPanelCtrl.hasError}" ng-show="!adminPanelCtrl.sending">{{adminPanelCtrl.successMessage}}</h3>
                        <br>
                    <table class="table">
                        <thead>
                        <tr>
                            <th></th>
                            <th>{{admin-user}}</th>
                            <th>{{admin-email}}</th>
                            <th>{{admin-role}}</th>
                            <th>{{admin-registered}}</th>
                            <!--<th>Logged In</th>-->
                            <th>{{Action}}</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="user in adminPanelCtrl.adminPanelUsersArray" class="pointer">
                            <td><input type="checkbox" ng-model="user.selected" ng-init="user.selected = false"></td>
                            <td ng-click="adminPanelCtrl.changeView('editUser');adminPanelCtrl.decryptUser(user);">{{user.username}}</td>
                            <td ng-click="adminPanelCtrl.changeView('editUser');adminPanelCtrl.decryptUser(user);">{{user.email}}</td>
                            <td ng-click="adminPanelCtrl.changeView('editUser');adminPanelCtrl.decryptUser(user);" ng-init="adminPanelCtrl.sortRoles(user.roles)">{{user.roles[0] === 'employee' ? 'officer' : user.roles[0] | uppercase}}</td>
                            <td ng-click="adminPanelCtrl.changeView('editUser');adminPanelCtrl.decryptUser(user);">{{user.createdAt | date:'mediumDate'}}</td>
                            <!--<td>Yes</td>-->
                            <td>
                                <a href="mailto:{{user.email}}" id="blackLink"><img class="list-action-img img-circle" src="/resources/images/mail.png"/></a>
                                <a><img ng-click="adminPanelCtrl.changeView('editUser');adminPanelCtrl.decryptUser(user);" class="list-action-img img-circle" src="/resources/images/edit.png"/></a>
                                <a ng-click="adminPanelCtrl.selectUser(user); adminPanelCtrl.deleteUser()"><img class="list-action-img img-circle" src="/resources/images/delete.png"/></a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <!--=====PAGINATOR======-->
                    <!--====================-->
                    <div ng-if="adminPanelCtrl.usersAvailable" class="admin-panel-paginator-container">
                        <ul id="paginator">

                            <li class="paginator-control" ng-click="adminPanelCtrl.getPage(1)">
                                <span class="fa fa-chevron-left fa-lg" ng-class="{'disabled-link': adminPanelCtrl.currentPageNum===1}"></span><span class="fa fa-chevron-left fa-lg " ng-class="{'disabled-link': adminPanelCtrl.currentPageNum===1}"></span>
                            </li>

                            <li id="page-previous" class="paginator-control" ng-class="{'disabled-link': adminPanelCtrl.currentPageNum===1}" ng-click="adminPanelCtrl.getPage(adminPanelCtrl.currentPageNum - 1)">
                                <span class="fa fa-chevron-left fa-lg"></span>
                            </li>


                            <li class="paginator-control" ng-repeat="pageNumber in adminPanelCtrl.pageNumbers" ng-class="{'light-blue': adminPanelCtrl.currentPageNum === pageNumber}" ng-click="adminPanelCtrl.getPage(pageNumber)">
                                {{pageNumber}}
                            </li>


                            <li id="page-next" class="paginator-control" ng-class="{'disabled-link': adminPanelCtrl.currentPageNum === adminPanelCtrl.lastPageNum}" ng-click="adminPanelCtrl.getPage(adminPanelCtrl.currentPageNum + 1)">
                                <span class="fa fa-chevron-right fa-lg"></span>
                            </li>

                            <li class="paginator-control" ng-click="adminPanelCtrl.getPage(adminPanelCtrl.lastPageNum)">
                                <span class="fa fa-chevron-right fa-lg" ng-class="{'disabled-link': adminPanelCtrl.currentPageNum === adminPanelCtrl.lastPageNum}"></span><span class="fa fa-chevron-right fa-lg" ng-class="{'disabled-link': adminPanelCtrl.currentPageNum === adminPanelCtrl.lastPageNum}"></span>
                            </li>

                        </ul>
                    </div>
                </div>
                <div class="tab-pane" ng-class="{'active':adminPanelCtrl.addingUser || adminPanelCtrl.editingUser}">
                    <div class="row">
                        <h3 ng-show="adminPanelCtrl.addingUser" class="text-center">{{admin-addofficer}}</h3>
                        <h3 ng-show="adminPanelCtrl.editingUser" class="text-center">{{admin-editOfficer}}</h3>
                        <h3 class="text-center"  ng-class="{'green':!adminPanelCtrl.hasError, 'red':adminPanelCtrl.hasError}" ng-show="!adminPanelCtrl.sending">{{adminPanelCtrl.successMessage}}</h3>
                        <br>

                        <form role="form" name="addOfficerForm" class="userForm" novalidate>
                            <div class="row">
                                <div class="col-xs-3 col-xs-offset-1">
                                    <div class="form-group">
                                        <label for="new-officer-fname" class="dark-gray">{{admin-fName}}</label>
                                        <input type="text" class="form-control" id="new-officer-fname" placeholder="First Name" ng-model="adminPanelCtrl.formUser.firstName"  required/>
                                    </div>

                                    <div class="form-group">
                                        <label for="new-officer-lname" class="dark-gray">{{admin-lName}}</label>
                                        <input type="text" class="form-control" id="new-officer-lname" placeholder="Last Name" ng-model="adminPanelCtrl.formUser.lastName" required/>
                                    </div>

                                    <div class="form-group">
                                        <label for="new-officer-username" class="dark-gray">{{admin-user}}</label>
                                        <input ng-disabled="adminPanelCtrl.editingUser" type="text" class="form-control" id="new-officer-username" placeholder="Username or Badge Number" ng-model="adminPanelCtrl.formUser.username" name="username" ng-required="adminPanelCtrl.addingUser"/>
                                    </div>

                                    <div class="form-group">
                                        <label for="new-officer-email" class="dark-gray">{{admin-email}}</label>
                                        <input type="email" class="form-control" id="new-officer-email" placeholder="Email" ng-model="adminPanelCtrl.formUser.email" required/>
                                    </div>

                                    <div class="form-group">
                                        <label for="new-officer-phone" class="dark-gray">{{admin-phone}}</label>
                                        <input type="text" class="form-control" id="new-officer-phone" placeholder="Phone Number" ng-model="adminPanelCtrl.formUser.phoneNumber" required/>
                                    </div>
                                </div>
                                <div class="col-xs-3">
                                    <div class="form-group">
                                        <label for="address-1" class="dark-gray">{{admin-address1}}</label>
                                        <input type="text" class="form-control" id="address-1" placeholder="Address line 1" ng-model="adminPanelCtrl.formUser.addressLine1"/>
                                    </div>

                                    <div class="form-group">
                                        <label for="address-2" class="dark-gray">{{admin-address2}}</label>
                                        <input type="text" class="form-control" id="address-2" placeholder="Address line 2" ng-model="adminPanelCtrl.formUser.addressLine2"/>
                                    </div>

                                    <div class="form-group">
                                        <label for="city" class="dark-gray">{{admin-city}}</label>
                                        <input type="text" class="form-control" id="city" placeholder="City" ng-model="adminPanelCtrl.formUser.city"/>
                                    </div>

                                    <div class="form-group">
                                        <label for="new-officer-state" class="dark-gray">{{admin-state}}</label>
                                        <select id="new-officer-state" class="form-control" ng-model="adminPanelCtrl.formUser.state" ng-init="adminPanelCtrl.formUser.state='Select'">
                                            <option ng-repeat="state in adminPanelCtrl.states" value="{{state}}">{{admin-state}}</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label for="new-officer-zip-code" class="dark-gray">Zip Code</label>
                                        <input type="text" maxlength="11" class="form-control" id="new-officer-zip-code" placeholder="Zip Code" ng-model="adminPanelCtrl.formUser.zipCode" required/>
                                    </div>
                                </div>
                                <div class="col-xs-3">
                                    <div ng-show="adminPanelCtrl.addingUser" class="form-group">
                                        <label for="new-officer-password" class="dark-gray">{{admin-password}}</label>
                                        <input ng-disabled="adminPanelCtrl.editingUser" type="password" class="form-control" id="new-officer-password" placeholder="Password" ng-model="adminPanelCtrl.formUser.password" ng-required="adminPanelCtrl.addingUser"/>
                                    </div>

                                    <div ng-show="adminPanelCtrl.editingUser" class="form-group">
                                        <label for="new-officer-role" class="dark-gray">{{admin-setRole}}</label>
                                        <select id="new-officer-role" class="form-control" ng-model="adminPanelCtrl.formUser.roles[0]" required>
                                            <option ng-repeat="role in adminPanelCtrl.roles" value="{{role}}">{{role | uppercase}}</option>
                                        </select>
                                    </div>

                                    <div ng-show="adminPanelCtrl.addingUser" class="form-group">
                                        <label for="existing-officer-role" class="dark-gray">{{admin-setRole}}</label>
                                        <select id="existing-officer-role" class="form-control" ng-model="adminPanelCtrl.formUser.roles" required>
                                            <option ng-repeat="role in adminPanelCtrl.roles" value="{{role}}">{{role | uppercase}}</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label for="new-officer-role" class="dark-gray">{{admin-permissions}}</label>
                                        <select class="form-control selectpicker" id="permission-select" ng-model="adminPanelCtrl.formUser.permissions" title="Choose one or more" multiple required>
                                            <option id="no-access" value="none">{{admin-none}}</option>
                                            <option id="video-access" value="video">{{admin-video}}</option>
                                            <option id="chat-access" value="chat">{{admin-chat}}</option>
                                            <option id="notifications-access" value="notifications">{{admin-notifications}}</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <button type="submit" class="btn btn-primary col-xs-2 col-xs-offset-5" ng-click="addOfficerForm.$valid && adminPanelCtrl.saveUser()">
                                    <span ng-hide="adminPanelCtrl.sending">{{admin-save}}</span>
                                    <div class="spinner" ng-show="adminPanelCtrl.sending">
                                        <div class="bounce1"></div>
                                        <div class="bounce2"></div>
                                        <div class="bounce3"></div>
                                    </div>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>


</div>
